<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Koolo</title>

<style>

body{
margin:0;
font-family:Arial,Helvetica,sans-serif;
background:white;
color:black;
}

/* HEADER */
header{
display:flex;
align-items:center;
justify-content:space-between;
padding:15px;
background:black;
color:white;
flex-wrap:nowrap;
}

.header-left{
display:flex;
align-items:center;
gap:12px;
}

#logo{
height:45px;
}

.header-left a{
color:white;
text-decoration:none;
font-weight:bold;
}

.header-right{
display:flex;
align-items:center;
gap:10px;
}

.header-right button{
background:white;
color:black;
border:none;
padding:6px 12px;
border-radius:4px;
cursor:pointer;
}

/* MOBILE */
@media(max-width:768px){
header{
flex-direction:row;
justify-content:space-between;
}
.header-left,.header-right{
width:auto;
}
}

/* PRODUCTS */
#products{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:20px;
padding:20px;
}

.product{
border:1px solid black;
padding:10px;
width:180px;
text-align:center;
transition:.2s;
}

.product:hover{transform:scale(1.05)}

.product img{
width:120px;
height:120px;
}

.product button{
background:black;
color:white;
border:none;
padding:6px;
margin-top:5px;
cursor:pointer;
transition:0.2s;
}

.product button:hover{
background:#333;
}

/* CART PREMIUM ANIMADO */
#cart{
display:block;
position:fixed;
top:80px;
right:-320px; /* fuera de pantalla */
background:white;
border-radius:10px;
border:1px solid #ccc;
padding:15px;
width:280px;
max-height:400px;
overflow:auto;
z-index:100;
box-shadow:0 8px 20px rgba(0,0,0,0.3);
transition: all 0.4s ease;
opacity:0;
}

#cart.open{
right:10px;
opacity:1;
}

#cart h3{
margin-top:0;
text-align:center;
}

#checkoutBtn{
background:black;
color:white;
border:none;
padding:8px 12px;
border-radius:6px;
cursor:pointer;
width:100%;
margin-top:10px;
font-weight:bold;
transition: transform 0.3s ease, background 0.3s ease;
}

#checkoutBtn.show{
transform: scale(1.1);
background:#222;
}

/* MODALS */
.modal{
display:none;
position:fixed;
top:0;left:0;
width:100%;
height:100%;
background:rgba(0,0,0,.6);
z-index:200;
}

.modal-content{
background:white;
width:320px;
margin:10% auto;
padding:15px;
}

.modal-content input{
width:100%;
margin:5px 0;
padding:6px;
}

.admin-product{
border:1px solid #ccc;
padding:5px;
margin:5px 0;
}

.admin-product img{width:40px}

/* ANIMACIÃ“N PRODUCTO EN CARRITO */
.cart-item {
  opacity: 0;
  transform: translateX(50px);
  transition: all 0.4s ease;
}

/* Contador animado */
#count {
  display: inline-block;
  transition: transform 0.2s ease;
}

/* TOAST PRODUCTO AÃ‘ADIDO */
#toast {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background: black;
  color: white;
  padding: 10px 20px;
  border-radius: 8px;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.5s ease, transform 0.5s ease;
  z-index: 500;
}

#toast.show {
  opacity: 1;
  transform: translateX(-50%) translateY(-10px);
}

</style>
</head>

<body>

<header>
<div class="header-left">
<img src="img/logo.png" id="logo">
<a href="#" id="inicio">Inicio</a>
<a href="#" id="categorias">CategorÃ­as</a>
</div>

<div class="header-right">
<button id="loginBtn">Login</button>
<button id="cartBtn">ðŸ›’ <span id="count">0</span></button>
<button id="adminBtn" style="display:none">Admin</button>
</div>
</header>

<main id="products"></main>

<div id="cart">
<h3>Carrito</h3>
<div id="cartItems"></div>
<hr>
<button id="checkoutBtn">Finalizar compra</button>
<div id="paypal-button-container" style="margin-top:10px;"></div>
<div id="payments"></div>
</div>

<!-- LOGIN -->
<div class="modal" id="loginModal">
<div class="modal-content">
<h3>Registro / Login</h3>
<input id="name" placeholder="Nombre">
<input id="email" placeholder="Correo">
<input id="pass" type="password" placeholder="ContraseÃ±a">
<input id="address" placeholder="DirecciÃ³n envÃ­o">
<button id="loginSubmit">Entrar</button>
</div>
</div>

<!-- ADMIN -->
<div class="modal" id="adminModal">
<div class="modal-content">
<input id="adminPass" type="password" placeholder="Password admin">
<button id="adminEnter">Entrar</button>
</div>
</div>

<div class="modal" id="adminPanel">
<div class="modal-content">
<h3>Mini Admin</h3>
<input id="logoInput" placeholder="img/logo.png">
<input type="color" id="color">

<h4>Productos</h4>
<div id="adminProducts"></div>
<button id="addProduct">AÃ±adir producto</button>

<h4>MÃ©todos de pago</h4>
<input type="file" id="payUpload" multiple>
<button id="saveAdmin">Guardar</button>
</div>
</div>

<!-- TOAST -->
<div id="toast">Producto aÃ±adido al carrito</div>

<!-- PAYPAL SDK: reemplaza client-id por tu Sandbox -->
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_SANDBOX_CLIENT_ID&currency=EUR"></script>

<script>

const ADMIN="1234";

let products=[
{name:"Camiseta",price:20,img:"img/camiseta.png"},
{name:"Sudadera",price:35,img:"img/sudadera.png"},
{name:"Gorra",price:15,img:"img/gorra.png"}
];

let cart=[];
let payments=[];

const prodDiv=document.getElementById("products");
const cartDiv=document.getElementById("cart");

function draw(){
prodDiv.innerHTML="";
products.forEach((p, i)=>{
let d=document.createElement("div");
d.className="product";
d.innerHTML=`<img src="${p.img}"><h4>${p.name}</h4>${p.price}â‚¬<br><button>AÃ±adir</button>`;
prodDiv.appendChild(d);

// AnimaciÃ³n y toast al aÃ±adir producto
d.querySelector("button").onclick=()=>{
  cart.push(p);
  updateCart();
  animateCheckoutBtn();
  showToast(`${p.name} aÃ±adido al carrito`);
};
});
}
draw();

function updateCart(){
cartItems.innerHTML="";
cart.forEach((c, i)=>{
  let div=document.createElement("div");
  div.textContent=`${c.name} ${c.price}â‚¬`;
  div.className="cart-item";
  cartItems.appendChild(div);
  setTimeout(()=>{div.style.opacity="1"; div.style.transform="translateX(0)";}, i*100);
});
count.textContent=cart.length;
count.classList.add("animate");
setTimeout(()=>count.classList.remove("animate"),300);

let user=JSON.parse(localStorage.getItem("user"));
if(user) cartItems.innerHTML+=`<hr>${user.address}`;

paymentsDiv.innerHTML="";
payments.forEach(p=>{
let i=document.createElement("img");
i.src=p;i.style.width="40px";
paymentsDiv.appendChild(i);
});

updatePayPalButton();
}

cartBtn.onclick=()=>cartDiv.classList.toggle("open");

/* LOGIN */
loginBtn.onclick=()=>loginModal.style.display="block";
loginSubmit.onclick=()=>{
localStorage.setItem("user",JSON.stringify({
name:name.value,email:email.value,address:address.value
}));
loginModal.style.display="none";
updateCart();
}

/* ADMIN */
window.onload=()=>{
let p=prompt("Admin password:");
if(p===ADMIN) adminBtn.style.display="inline-block";
}

adminBtn.onclick=()=>adminModal.style.display="block";
adminEnter.onclick=()=>{
if(adminPass.value===ADMIN){
adminModal.style.display="none";
adminPanel.style.display="block";
renderAdmin();
}
}

function renderAdmin(){
adminProducts.innerHTML="";
products.forEach(p=>{
let d=document.createElement("div");
d.className="admin-product";
d.innerHTML=`<img src="${p.img}">
<input value="${p.name}">
<input type="number" value="${p.price}">
<input type="file">`;
adminProducts.appendChild(d);
});
}

addProduct.onclick=()=>{
products.push({name:"Nuevo",price:0,img:"img/logo.png"});
renderAdmin();
}

payUpload.onchange=e=>{
[...e.target.files].forEach(f=>{
let r=new FileReader();
r.onload=x=>{payments.push(x.target.result);updateCart()}
r.readAsDataURL(f);
});
}

saveAdmin.onclick=()=>{
document.getElementById("logo").src=logoInput.value;
document.querySelector("header").style.background=color.value;
draw();
adminPanel.style.display="none";
}

/* NAV */
inicio.onclick=()=>draw();
categorias.onclick=()=>alert("CategorÃ­as prÃ³ximamente");

/* PAYPAL */
function getTotal(){return cart.reduce((sum,p)=>sum+p.price,0);}
function updatePayPalButton(){
paypal.Buttons({
style:{layout:'vertical',color:'gold',shape:'rect',label:'paypal'},
createOrder:function(data,actions){
return actions.order.create({
purchase_units:[{amount:{value:getTotal().toFixed(2)}}]
});
},
onApprove:function(data,actions){
return actions.order.capture().then(function(details){
alert('Pago completado por '+details.payer.name.given_name+'!\nTotal: â‚¬'+getTotal().toFixed(2));
cart=[]; updateCart();
});
}
}).render('#paypal-button-container');
}

/* ANIMACIONES FINALES */
function animateCheckoutBtn(){
checkoutBtn.classList.add("show");
setTimeout(()=>checkoutBtn.classList.remove("show"),300);
}

function showToast(msg){
const toast=document.getElementById("toast");
toast.textContent=msg;
toast.classList.add("show");
setTimeout(()=>toast.classList.remove("show"),1500);
}

checkoutBtn.onclick=()=>{
if(cart.length===0){alert("El carrito estÃ¡ vacÃ­o"); return;}
document.getElementById("paypal-button-container").scrollIntoView({behavior:"smooth"});
}

</script>

</body>
</html>
