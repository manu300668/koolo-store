<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Koolo Store</title>
<style>
/* ====== CSS INTEGRADO ====== */
body {
  margin:0;
  font-family: Arial, sans-serif;
}

header {
  display:flex;
  justify-content: space-between;
  align-items:center;
  padding:10px 20px;
  background-color: #fff;
}

.header-left img {
  height:50px;
}

.header-right button {
  margin-left:10px;
  padding:5px 10px;
  cursor:pointer;
}

main#products {
  display:flex;
  flex-wrap:wrap;
  gap:15px;
  padding:20px;
}

.product {
  border:1px solid #ccc;
  padding:10px;
  width:150px;
  text-align:center;
}

.product img {
  width:100px;
  height:100px;
}

aside#cart {
  display:none;
  position:fixed;
  top:60px;
  right:10px;
  background:#fff;
  border:1px solid #ccc;
  padding:10px;
  width:250px;
  max-height:400px;
  overflow:auto;
  z-index:100;
}

/* Mini admin y modal */
.modal {
  display: none; 
  position: fixed; 
  z-index: 1000; 
  left: 0;
  top: 0;
  width: 100%; 
  height: 100%;
  overflow: auto; 
  background-color: rgba(0,0,0,0.5);
}

.modal-content {
  background-color: #fff;
  margin: 10% auto;
  padding: 20px;
  width: 360px;
  border-radius: 5px;
}

#close-login, #close-admin, #close-admin-panel {
  float: right;
  font-size: 20px;
  cursor: pointer;
}

#admin-panel input {
  width: 100%;
  margin: 5px 0;
  padding: 5px;
  box-sizing: border-box;
}
#admin-panel button {
  margin-top: 10px;
  padding: 8px 12px;
  background-color: black;
  color: white;
  border: none;
  cursor: pointer;
}
.admin-product {
  border:1px solid #ccc;
  padding:5px;
  margin-bottom:5px;
}
.admin-product img {
  width: 50px;
  height: 50px;
  display: block;
  margin-bottom:5px;
}
</style>
</head>

<body>

<header>
  <div class="header-left">
    <img src="img/logo.png" id="logo" alt="Koolo Logo">
  </div>

  <div class="header-right">
    <button id="login-btn">Login</button>
    <button id="cartBtn">ðŸ›’ <span id="cart-count">0</span></button>
    <button id="admin-btn">Admin</button>
  </div>
</header>

<main id="products"></main>

<aside id="cart">
  <div class="modal-content">
    <h3>Carrito</h3>
    <div id="cartItems"></div>
  </div>
</aside>

<!-- Login modal usuario -->
<div id="login-modal" class="modal">
  <div class="modal-content">
    <span id="close-login">&times;</span>
    <h3>Login</h3>
    <input type="email" id="login-email" placeholder="Correo">
    <input type="password" id="login-pass" placeholder="ContraseÃ±a">
    <button id="login-submit">Entrar</button>
  </div>
</div>

<!-- Login modal admin -->
<div id="admin-modal" class="modal">
  <div class="modal-content">
    <span id="close-admin">&times;</span>
    <h3>Admin Login</h3>
    <input type="password" id="admin-pass" placeholder="ContraseÃ±a admin">
    <button id="admin-login-submit">Entrar</button>
  </div>
</div>

<!-- Panel admin avanzado -->
<div id="admin-panel" class="modal">
  <div class="modal-content">
    <span id="close-admin-panel">&times;</span>
    <h3>Mini Admin Avanzado</h3>

    <label>Logo URL:</label>
    <input type="text" id="admin-logo" placeholder="img/logo.png">

    <label>Color de cabecera:</label>
    <input type="color" id="admin-color" value="#ffffff">

    <label>Instagram URL:</label>
    <input type="text" id="admin-instagram" placeholder="https://instagram.com/...">

    <h4>Productos</h4>
    <div id="admin-products"></div>
    <button id="admin-add-product">AÃ±adir producto</button>

    <button id="admin-save">Guardar cambios</button>
  </div>
</div>

<script>
// ====== JS INTEGRADO ======

let products = [
  {name:"Camiseta Koolo",price:20,img:"img/camiseta.png"},
  {name:"Sudadera Koolo",price:35,img:"img/sudadera.png"},
  {name:"Gorra Koolo",price:15,img:"img/gorra.png"}
];

const productsDiv=document.getElementById("products");
const cartDiv=document.getElementById("cart");
const cartBtn=document.getElementById("cartBtn");
const cartItems=document.getElementById("cartItems");
const cartCount=document.getElementById("cart-count");
const loginBtn=document.getElementById("login-btn");

// Admin
const adminBtn=document.getElementById("admin-btn");
const adminModal=document.getElementById("admin-modal");
const closeAdmin=document.getElementById("close-admin");
const adminLoginSubmit=document.getElementById("admin-login-submit");
const adminPanel=document.getElementById("admin-panel");
const closeAdminPanel=document.getElementById("close-admin-panel");
const adminLogo=document.getElementById("admin-logo");
const adminColor=document.getElementById("admin-color");
const adminInstagram=document.getElementById("admin-instagram");
const adminProductsDiv=document.getElementById("admin-products");
const adminAddProduct=document.getElementById("admin-add-product");
const adminSave=document.getElementById("admin-save");

let cart=[];

function drawProducts(){
  productsDiv.innerHTML="";
  products.forEach((p,i)=>{
    const d=document.createElement("div");
    d.className="product";
    d.innerHTML=`
      <img src="${p.img}" alt="${p.name}">
      <h3>${p.name}</h3>
      <p>${p.price}â‚¬</p>
      <button>AÃ±adir</button>
    `;
    d.querySelector("button").onclick=()=>{
      cart.push(p);
      drawCart();
    };
    productsDiv.appendChild(d);
  });
}
drawProducts();

function drawCart(){
  cartItems.innerHTML="";
  cart.forEach((p,i)=>{
    cartItems.innerHTML+=`${p.name} ${p.price}â‚¬ <button onclick="removeItem(${i})">X</button><br>`;
  });
  cartCount.textContent = cart.length;
}
function removeItem(i){cart.splice(i,1); drawCart();}
cartBtn.onclick=()=>{cartDiv.classList.toggle("open");}

// Login usuario
const loginModal=document.getElementById("login-modal");
const closeLogin=document.getElementById("close-login");
const loginSubmit=document.getElementById("login-submit");
loginBtn.onclick=()=>{loginModal.style.display="block";}
closeLogin.onclick=()=>{loginModal.style.display="none";}
window.onclick=(e)=>{if(e.target==loginModal){loginModal.style.display="none";}}
loginSubmit.onclick=()=>{
  const email=document.getElementById("login-email").value;
  const pass=document.getElementById("login-pass").value;
  alert(`Login simulado:\nCorreo: ${email}\nContraseÃ±a: ${pass}`);
  loginModal.style.display="none";
}

// Admin login
const ADMIN_PASSWORD="1234";
adminBtn.onclick=()=>{adminModal.style.display="block";}
closeAdmin.onclick=()=>{adminModal.style.display="none";}
adminLoginSubmit.onclick=()=>{
  const pass=document.getElementById("admin-pass").value;
  if(pass===ADMIN_PASSWORD){ adminModal.style.display="none"; openAdminPanel(); }
  else{ alert("ContraseÃ±a incorrecta"); }
}

closeAdminPanel.onclick=()=>{adminPanel.style.display="none";}

function openAdminPanel(){
  adminPanel.style.display="block";
  adminLogo.value=document.getElementById("logo").src;
  adminColor.value="#ffffff";
  adminInstagram.value=localStorage.getItem("instagram")||"";
  renderAdminProducts();
}

function renderAdminProducts(){
  adminProductsDiv.innerHTML="";
  products.forEach((p,i)=>{
    const d=document.createElement("div");
    d.className="admin-product";
    d.innerHTML=`
      <img src="${p.img}" alt="${p.name}">
      <input type="text" value="${p.name}" placeholder="Nombre">
      <input type="number" value="${p.price}" placeholder="Precio">
      <input type="file" id="upload-${i}">
      <button onclick="removeAdminProduct(${i})">Eliminar</button>
    `;
    adminProductsDiv.appendChild(d);

    const fileInput = document.getElementById(`upload-${i}`);
    fileInput.addEventListener("change", (e)=>{
      const reader = new FileReader();
      reader.onload = function(ev){
        p.img = ev.target.result;
        renderAdminProducts();
        drawProducts();
      }
      reader.readAsDataURL(e.target.files[0]);
    });
  });
}

adminAddProduct.onclick=()=>{
  products.push({name:"Nuevo producto",price:0,img:"img/logo.png"});
  renderAdminProducts();
}
window.removeAdminProduct=(i)=>{products.splice(i,1); renderAdminProducts();}

adminSave.onclick=()=>{
  document.getElementById("logo").src=adminLogo.value;
  document.querySelector("header").style.backgroundColor=adminColor.value;
  localStorage.setItem("instagram",adminInstagram.value);
  const inputs=adminProductsDiv.querySelectorAll("input[type=text],input[type=number]");
  for(let i=0;i<products.length;i++){
    products[i].name=inputs[i*2].value;
    products[i].price=parseFloat(inputs[i*2+1].value);
  }
  drawProducts();
  alert("Cambios guardados!");
  adminPanel.style.display="none";
}
</script>

</body>
</html>
